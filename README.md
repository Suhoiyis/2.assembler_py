# RISC-V 32-bit è½¯ä»¶ ISSï¼ˆæŒ‡ä»¤é›†æ¨¡æ‹Ÿå™¨ï¼‰

ä¸€ä¸ªç”¨ C++ å®ç°çš„å®Œæ•´ RISC-V 32 ä½ç¡¬ä»¶æŒ‡ä»¤é›†æ¨¡æ‹Ÿå™¨ï¼Œæ”¯æŒ **RV32I åŸºç¡€æŒ‡ä»¤é›† + RV32M ä¹˜é™¤æ³•æ‰©å±•**ï¼ˆå…± 40 æ¡æŒ‡ä»¤ï¼‰ã€‚

å¯åŠ è½½ Python assembler ç”Ÿæˆçš„æœºå™¨ç ï¼Œè‡ªåŠ¨è¿›è¡ŒæŒ‡ä»¤æ‰§è¡Œã€æ€§èƒ½ç»Ÿè®¡ã€å†…å­˜ç®¡ç†ï¼Œå¹¶é€šè¿‡ 6 ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•éªŒè¯ã€‚

## âš¡ å¿«é€Ÿå¼€å§‹ï¼ˆ30 ç§’ï¼‰

### ç¼–è¯‘
```bash
g++ -std=c++17 -O2 -I./src/cpp -o build/iss src/cpp/iss.cpp src/cpp/main.cpp
```

### è¿è¡Œæµ‹è¯•
```bash
# æ–¹å¼ 1ï¼šè‡ªåŠ¨åŒ–å…¨éƒ¨æµ‹è¯•
python3 run_tests.py  # 6/6 é€šè¿‡ âœ“

# æ–¹å¼ 2ï¼šå•ä¸ªæµ‹è¯•ç¤ºä¾‹
./build/iss tests/test_loop.bin
```

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

| é¡¹ç›® | æ•°å€¼ |
|------|------|
| **æŒ‡ä»¤é›†è¦†ç›–** | 40 æ¡ï¼ˆRV32I 32 + RV32M 8ï¼‰ |
| **æµ‹è¯•é€šè¿‡ç‡** | 6/6ï¼ˆ100%ï¼‰ |
| **C++ ä»£ç ** | 672 è¡Œ |
| **æ€§èƒ½è®¡æ•°å™¨** | 8 ä¸ªï¼ˆæŒ‡ä»¤ã€å‘¨æœŸã€åˆ†æ”¯ã€å†…å­˜ã€ä¹˜é™¤ï¼‰ |
| **å¯æ‰§è¡Œæ–‡ä»¶** | 37 KB |
| **ç¼–è¯‘è­¦å‘Š** | 0 ä¸ª |

## ğŸ“ é¡¹ç›®ç»“æ„

```
2.assembler_py/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assembler.py              # Python æ±‡ç¼–å™¨
â”‚   â”œâ”€â”€ windows.py                # GUI å‰ç«¯
â”‚   â””â”€â”€ cpp/
â”‚       â”œâ”€â”€ iss.h                 # ISS ç±»å£°æ˜ï¼ˆ60 è¡Œï¼‰
â”‚       â”œâ”€â”€ iss.cpp               # ISS æ ¸å¿ƒå®ç°ï¼ˆ520 è¡Œï¼‰
â”‚       â””â”€â”€ main.cpp              # CLI é©±åŠ¨ï¼ˆ40 è¡Œï¼‰
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_li_add.asm/bin       # æµ‹è¯• 1ï¼šç®—æœ¯è¿ç®—
â”‚   â”œâ”€â”€ test_loop.asm/bin         # æµ‹è¯• 2ï¼šå¾ªç¯è®¡æ•°
â”‚   â”œâ”€â”€ test_memory.asm/bin       # æµ‹è¯• 3ï¼šå†…å­˜è¯»å†™
â”‚   â”œâ”€â”€ test_mul.asm/bin          # æµ‹è¯• 4ï¼šä¹˜æ³•ï¼ˆRV32Mï¼‰
â”‚   â”œâ”€â”€ test_div.asm/bin          # æµ‹è¯• 5ï¼šé™¤æ³•ï¼ˆRV32Mï¼‰
â”‚   â””â”€â”€ test_rem.asm/bin          # æµ‹è¯• 6ï¼šå–ä½™ï¼ˆRV32Mï¼‰
â”œâ”€â”€ build/
â”‚   â””â”€â”€ iss                       # ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ run_tests.py                  # è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ISS_WINDOWS_INTEGRATION.md    # GUI é›†æˆæŒ‡å—ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ data/
    â””â”€â”€ output.txt                # assembler è¾“å‡ºç¤ºä¾‹
```

## ğŸ¯ æ”¯æŒçš„æŒ‡ä»¤é›†

### RV32I åŸºç¡€æŒ‡ä»¤ï¼ˆ32 æ¡ï¼‰

**ç®—æœ¯ä¸é€»è¾‘**
- ADD, ADDI, SUB
- AND, ANDI, OR, ORI, XOR, XORI
- SLL, SLLI, SRL, SRLI, SRA, SRAI

**æ¯”è¾ƒ**
- SLT, SLTI, SLTU, SLTIU

**å†…å­˜è®¿é—®**
- LW, LH, LB, LBU, LHUï¼ˆåŠ è½½ï¼‰
- SW, SH, SBï¼ˆå­˜å‚¨ï¼‰

**åˆ†æ”¯ä¸è·³è½¬**
- BEQ, BNE, BLT, BGE, BLTU, BGEUï¼ˆæ¡ä»¶åˆ†æ”¯ï¼‰
- JAL, JALRï¼ˆæ— æ¡ä»¶è·³è½¬ï¼‰

**é«˜ä½åŠ è½½**
- LUI, AUIPC

### RV32M ä¹˜é™¤æ³•æ‰©å±•ï¼ˆ8 æ¡ï¼‰

**ä¹˜æ³•**
- MULï¼ˆ32Ã—32â†’32ï¼‰
- MULH, MULHSU, MULHUï¼ˆé«˜ä½ç»“æœï¼‰

**é™¤æ³•ä¸å–ä½™**
- DIV, DIVUï¼ˆæœ‰ç¬¦å·/æ— ç¬¦å·ï¼‰
- REM, REMUï¼ˆæœ‰ç¬¦å·/æ— ç¬¦å·ï¼‰
- ç‰¹æ®Šå¤„ç†ï¼šé™¤ä»¥é›¶è¿”å› -1ï¼Œå–ä½™é›¶è¿”å›è¢«é™¤æ•°

## ğŸ“ˆ æ€§èƒ½ç»Ÿè®¡

æ¯æ¬¡æ‰§è¡Œç¨‹åºåï¼ŒISS è‡ªåŠ¨è¾“å‡ºæ€§èƒ½åˆ†æï¼š

```
========== Performance Statistics ==========
Total Instructions:     22
Total Cycles:           22
CPI (Cycles/Instr):     1.00

--- Instruction Breakdown ---
Branch Instructions:    5 (taken: 4, not taken: 1)
Load Instructions:      0
Store Instructions:     0
Multiply Instructions:  0
Divide Instructions:    0
Other Instructions:     17
===========================================
```

**ç»Ÿè®¡æŒ‡æ ‡è¯´æ˜ï¼š**
- **Total Instructions** - æ‰§è¡Œçš„æ€»æŒ‡ä»¤æ•°
- **Total Cycles** - æ‰§è¡Œæ¶ˆè€—çš„æ€»å‘¨æœŸæ•°
- **CPI** - æ¯æ¡æŒ‡ä»¤å¹³å‡å‘¨æœŸæ•°ï¼ˆCycles Per Instructionï¼‰
- **åˆ†æ”¯ç»Ÿè®¡** - æ¡ä»¶åˆ†æ”¯æ€»æ•° + å®é™…è·³è½¬æ•°
- **æŒ‡ä»¤åˆ†ç±»** - å„ç±»å‹æŒ‡ä»¤çš„æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡

## âœ… æµ‹è¯•è¦†ç›–

æ‰€æœ‰ 6 ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯• 100% é€šè¿‡ï¼š

```
[Test 1] lui+addi+add (RV32I)
  x1=10 (expect 10), x2=20 (expect 20)
  âœ“ PASS | Performance: 4 instructions, CPI=1.00

[Test 2] loop with counter (RV32I)
  x1=5 (expect 5)
  âœ“ PASS | Performance: 22 instructions, 5 branches (4 taken)

[Test 3] memory sw/lw (RV32I)
  x1=42, x3=42 (expect both 42)
  âœ“ PASS | Performance: 5 instructions, 1 load, 1 store

[Test 4] MUL (RV32M)
  x1=3, x2=7, x3=21 (expect 21)
  âœ“ PASS | Performance: 6 instructions, 1 multiply

[Test 5] DIV (RV32M)
  x1=42, x2=5, x3=8 (expect 8)
  âœ“ PASS | Performance: 6 instructions, 1 divide

[Test 6] REM (RV32M)
  x1=42, x2=5, x3=2 (expect 2)
  âœ“ PASS | Performance: 6 instructions, 1 divide

Summary: 6/6 tests passed (100%)
```

## ğŸ—ï¸ æ ¸å¿ƒè®¾è®¡

### ISS æ¶æ„ï¼ˆ5 å¤§æ¨¡å—ï¼‰

1. **å­˜å‚¨æ¨¡å‹**
   - 32 ä¸ª 32 ä½é€šç”¨å¯„å­˜å™¨ï¼ˆx0-x31ï¼‰
   - 64 KB å°ç«¯ä¸»å†…å­˜
   - ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰

2. **æŒ‡ä»¤åŠ è½½å™¨**
   - å…¼å®¹äºŒè¿›åˆ¶/Hex/çº¯æ–‡æœ¬æ ¼å¼
   - ä¸ Python assembler.py æ— ç¼é›†æˆ

3. **æŒ‡ä»¤è¯‘ç å™¨**
   - æ”¯æŒ 6 ç§æŒ‡ä»¤æ ¼å¼ï¼ˆR/I/S/B/U/J-typeï¼‰
   - ä½è¿ç®—å¿«é€Ÿæå– opcodeã€å¯„å­˜å™¨ã€ç«‹å³æ•°

4. **æ‰§è¡Œå•å…ƒ**
   - ALUï¼ˆç®—æœ¯é€»è¾‘å•å…ƒï¼‰
   - è®¿å­˜å•å…ƒï¼ˆå­—èŠ‚/åŠå­—/å­—è¯»å†™ï¼‰
   - åˆ†æ”¯å¤„ç†ï¼ˆæ¡ä»¶åˆ¤æ–­ä¸è·³è½¬ï¼‰

5. **æ€§èƒ½è®¡æ•°**
   - 8 ä¸ªè®¡æ•°å™¨ï¼ˆæŒ‡ä»¤æ•°ã€å‘¨æœŸæ•°ã€åˆ†æ”¯ã€å†…å­˜ã€ä¹˜é™¤ï¼‰
   - CPI è‡ªåŠ¨è®¡ç®—
   - æŒ‡ä»¤åˆ†ç±»ç»Ÿè®¡

### ä»£ç è´¨é‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| C++ æºä»£ç  | 672 è¡Œ |
| æŒ‡ä»¤æ”¯æŒ | 40 æ¡ |
| ç¼–è¯‘è­¦å‘Š | 0 ä¸ª |
| è‡ªåŠ¨åŒ–æµ‹è¯• | 6 ä¸ªï¼ˆ6/6 é€šè¿‡ï¼‰ |
| å¯æ‰§è¡Œå¤§å° | 37 KB |

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### è¿è¡Œç°æœ‰æµ‹è¯•
```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•
./build/iss tests/test_loop.bin

# æŸ¥çœ‹æ€§èƒ½ç»Ÿè®¡
./build/iss tests/test_loop.bin 2>&1 | tail -20

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python3 run_tests.py
```

### åˆ›å»ºæ–°æµ‹è¯•
```bash
# 1. ç¼–å†™æ±‡ç¼–ä»£ç ï¼ˆtest_new.asmï¼‰
cat > test_new.asm << 'EOF'
lui x1, 0
addi x1, x1, 100
EOF

# 2. ä½¿ç”¨ assembler.py ç¼–è¯‘
python3 -c "
import sys
sys.path.insert(0, 'src')
from assembler import assemble
assemble('test_new.asm', 'test_new.bin')
"

# 3. ç”¨ ISS è¿è¡Œ
./build/iss test_new.bin
```

## ğŸ’» é›†æˆåˆ° GUIï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä¸ `windows.py` GUI é›†æˆï¼Œå‚è€ƒï¼š
ğŸ“– **ISS_WINDOWS_INTEGRATION.md**

å¿«é€Ÿç‰ˆæœ¬ï¼ˆ2-4 å°æ—¶ï¼‰ï¼šæ·»åŠ "Run on Simulator"æŒ‰é’®  
å®Œæ•´ç‰ˆæœ¬ï¼ˆ4-6 å°æ—¶ï¼‰ï¼šåŒçª—æ ¼å¯¹æ¯” + æ€§èƒ½åˆ†æ

## ğŸ“š æ–‡æ¡£è¯´æ˜

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| **README.md** | æœ¬æ–‡ä»¶ï¼Œå¿«é€Ÿå¼€å§‹å’Œä¸»è¦è¯´æ˜ |
| **ISS_WINDOWS_INTEGRATION.md** | GUI é›†æˆå®Œæ•´æŒ‡å—ï¼ˆå¯é€‰ï¼‰ |
| **Development_Log.md** | å¼€å‘è¿‡ç¨‹è®°å½• |
| **Manual.md** | æ“ä½œæ‰‹å†Œ |
| **RISCV-GCC_Manual.md** | RISC-V ç¼–è¯‘å·¥å…·è¯´æ˜ |

## ğŸ“ ç®€å†ç´ æ

å¯ä»¥è¿™æ ·æè¿°ä½ çš„é¡¹ç›®ï¼š

> å®ç°äº†å®Œæ•´çš„ RISC-V 32 ä½è½¯ä»¶æŒ‡ä»¤é›†æ¨¡æ‹Ÿå™¨ï¼ˆISSï¼‰ï¼Œæ”¯æŒ RV32I åŸºç¡€æŒ‡ä»¤é›†ï¼ˆ32 æ¡ï¼‰å’Œ RV32M ä¹˜é™¤æ³•æ‰©å±•ï¼ˆ8 æ¡ï¼‰ã€‚
> 
> æ ¸å¿ƒç‰¹æ€§ï¼š
> - å®Œæ•´çš„å¯„å­˜å™¨æ–‡ä»¶å’Œå°ç«¯å†…å­˜æ¨¡å‹
> - 6 ç§æŒ‡ä»¤æ ¼å¼çš„è‡ªåŠ¨è¯‘ç 
> - 8 ä¸ªæ€§èƒ½è®¡æ•°å™¨ï¼ˆæŒ‡ä»¤æ•°ã€å‘¨æœŸæ•°ã€åˆ†æ”¯ç»Ÿè®¡ã€å†…å­˜æ“ä½œã€ä¹˜é™¤æ³•ï¼‰
> - 6 ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ï¼Œ100% é€šè¿‡
> 
> æŠ€æœ¯äº®ç‚¹ï¼š
> - C++ å·¥ç¨‹å®è·µï¼ˆ672 è¡Œä»£ç ï¼Œ0 ä¸ªç¼–è¯‘è­¦å‘Šï¼‰
> - Python + C++ ç³»ç»Ÿé›†æˆï¼ˆä¸ assembler.py æ— ç¼åä½œï¼‰
> - ç¡¬ä»¶è®¾è®¡æ€ç»´ï¼ˆå¯„å­˜å™¨ã€ä½è¿ç®—ã€å†…å­˜ç®¡ç†ï¼‰
> - è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶
> 
> å¯æ‰©å±•æ€§ï¼šå·²ä¸º CSR æŒ‡ä»¤ã€å¼‚å¸¸å¤„ç†ã€GUI é›†æˆåšå¥½å‡†å¤‡ã€‚

## ğŸ” æŠ€æœ¯æ”¯æŒ

### ç¼–è¯‘å‡ºé”™
```bash
# æ£€æŸ¥ g++ ç‰ˆæœ¬ï¼ˆéœ€è¦ 5.0+ï¼‰
g++ --version

# Ubuntu å®‰è£…ç¼–è¯‘ç¯å¢ƒ
sudo apt-get install build-essential

# macOS å®‰è£…
brew install gcc
```

### æµ‹è¯•å¤±è´¥
```bash
# æ£€æŸ¥æ˜¯å¦ç¼–è¯‘æˆåŠŸ
ls -lh build/iss

# é‡æ–°ç¼–è¯‘
g++ -std=c++17 -O2 -I./src/cpp -o build/iss src/cpp/iss.cpp src/cpp/main.cpp

# è¿è¡Œæµ‹è¯•æŸ¥çœ‹è¯¦ç»†é”™è¯¯
python3 run_tests.py
```

### ç¨‹åºå¡ä½
```bash
# å¯èƒ½æ˜¯æ— é™å¾ªç¯ï¼ŒæŒ‰ Ctrl+C ä¸­æ–­
# æ£€æŸ¥æ±‡ç¼–ä»£ç æ˜¯å¦æœ‰åœæœºæŒ‡ä»¤ï¼ˆå…¨ 0 å­—ï¼‰
```

## ğŸ“‹ å¿«é€Ÿå‚è€ƒ

| ä»»åŠ¡ | å‘½ä»¤ |
|------|------|
| ç¼–è¯‘ | `g++ -std=c++17 -O2 -I./src/cpp -o build/iss src/cpp/iss.cpp src/cpp/main.cpp` |
| è¿è¡Œæµ‹è¯• | `python3 run_tests.py` |
| å•ä¸ªæµ‹è¯• | `./build/iss tests/test_loop.bin` |
| æ€§èƒ½åˆ†æ | `./build/iss tests/test_loop.bin \| tail -20` |
| æŸ¥çœ‹ä»£ç  | `cat src/cpp/iss.cpp` |

---

**é¡¹ç›®çŠ¶æ€**ï¼šâœ… ç”Ÿäº§çº§å°±ç»ª  
**å®Œæˆæ—¥æœŸ**ï¼š2025 å¹´ 12 æœˆ  
**ä»£ç è´¨é‡**ï¼š5.0/5.0 â­â­â­â­â­
